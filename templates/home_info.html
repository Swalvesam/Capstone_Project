{% extends 'base.html' %}

{% block title %}Home Info Page
{% endblock %}

{% block head %}


<style>
#map {
    height: 500px;
    width: 75%;

  }
#pano {
    height: 500px;
    width: 75%;

  }
  html, body {
    margin: 0;
    padding: 0;

  }
#markers_info .marker {
    height: 40px;
    cursor: pointer;
}

</style>
<!-- Bootstrap links -->


<script type="text/javascript">
        let homeLatitude= {{ home_latitude | tojson }};
        let homeLongitude = {{ home_longitude | tojson }};
        let homeTitle = {{ home_address | tojson }};
        let businesses = {{ businesses | tojson }};
</script>
<!-- jQuery  -->
<script type="text/javascript" src="https://code.jquery.com/jquery-3.6.0.js"
integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
crossorigin="anonymous"> </script>
<!-- connecting javascript to page -->
<script type="text/javascript" src="/static/js/homeInfo.js"></script>
<!-- connects css -->
<link rel="stylesheet" href="/static/css/home_info.css">

<!-- QUill.js  -->
<!-- Main Quill library -->
<script src="//cdn.quilljs.com/1.3.6/quill.js"></script>
<script src="//cdn.quilljs.com/1.3.6/quill.min.js"></script>

<!-- Theme included stylesheets -->
<link href="//cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<link href="//cdn.quilljs.com/1.3.6/quill.bubble.css" rel="stylesheet">


<!-- google maps api -->
<script
defer
src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCo9kZSGr66VUlUwXP7odZ3fv0XuVBI4q0&callback=initMap">
</script>



{% endblock%}

{% block body %}


<div id="view_home_info">
        <b>Home Address:</b> {{ home_address }}<br>
        <div id="form-container" class="container">
            <form action="/add_home_note" id="add_home_note" method="POST">
                <input type="hidden" name="property_id" value="{{property_id}}">
                
                <label for="homeNote">Thoughts about home</label>
                <input name="note" type="hidden">
                <div id="editor-container" for="note">
                </div>

            <div class="row">
                <button class="btn btn-primary" type="submit" name="add_note">Add Note</button>
            </div>
            </form>
        
        
        </div>

        <b>Notes</b>
        
        <ul>

            
            <form action="/remove_home_note" method="POST" id="remove_home_note">
                <input type="hidden" name="property_id" value="{{property_id}}">
            {% for note in home_notes %}
            <li>{{note.created_at}}<br>{{note.body | safe}}<br></li>
            <button type="submit" name="remove_home_note" value={{note.home_note_id}} class="btn"><i class="bi bi-trash"></i></button>
            {% endfor %}
            </ul>
            </form>

        

       
        <div id="saved-businesses">

            <h2>Saved Businesses</h2>
            <form action="/remove_saved_bus" method="POST" id="remove_saved_business">
                {% if saved_bus %}
                    {% for b in saved_bus %}
                    <ul id="saved-bus"> 
                    <li>{{b.bus_name}}</li>
                        <ul>
                            <li><a href="{{b.yelp_url}}">View on Yelp</a></li>
                        <button type="submit" name="remove_saved_bus" value={{b.yelp_id}} class="btn"><i class="bi bi-trash"></i><</button>
                        </ul>
                    </ul>
                    {% endfor %}
                {% endif %}
                <input type="hidden" name="property_id" value="{{property_id}}"><!--pulling in to remove business-->
            </form> 
        </div>

        <div id=business_by_location>
            <h2>Businesses Close to Home</h2>
            <p2>
                <div id="markers-info">
                    <ul>
                        {% for bus in businesses %} {# loop.index0 #}
                        <form action="/save_business" method="POST">
                            <div class="markers">
                                <li> 
                                    {{bus[0]}}<!-- name-->
                                    <input type="hidden" id="name" name="name" value="{{bus[0]}}">
                                    <ul>
                                        <img src="{{bus[1]}}" width="80" height="80"> <!--img -->
                                        <li><a href="{{bus[2]}}"  ><img class="yelpBurst" src="/static/icons/burst.png"></img></a></li><!--yelp url-->
                                        <input type="hidden" value="{{bus[3]}}"><!--category-->
                                        <li>Rating: {{bus[4]}}</li><!-- rating-->
                                        <li>Review Count: {{bus[8]}}</li> <!-- # of reviews for business-->
                                        <input type="hidden" name ="coordinates" value="{{bus[5]}}"><!--coordinates-->
                                        <input type="hidden" name="latitude" value="{{bus[5].latitude}}"><!--latitude-->
                                        <input type="hidden" name="longitude" value="{{bus[5].longitude}}"><!--longitude-->
                                        <li>Distance: {{bus[6]}} miles</li><!--distance-->
                                        <li>Address: {{bus[7]}}</li><!-- location-->
                                        <input type="hidden" name="yelp_id"value="{{bus[9]}}"> <!--yelp id-->
                                        <input type="hidden" name="yelp_url" value="{{bus[2]}}"><!--yelp url-->
                                        <input type="hidden" name="property_id" value="{{property_id}}"><!--pulling in to save business-->
                                        <button type="submit">Save</button>
                                    </ul>
                                </li>
                            </div>
                        </form>
                        {% endfor %}
                            
                    </ul>
                </div>

            </p2>

        </div>
        <input type="hidden" id="home-longitude" value={{home_longitude}}>
        <input type="hidden" id="home-latitude" value={{home_latitude}}>
        

        <h3>Map to go here</h3>
        
        <div id="map" class="busMap"> </div>
        <div id="pano"></div>
        
    


</div>
<div>
    <form action="/return_to_user_dashboard">
        <button type="submit" name="return_to_user">Return to User Dashboard</button>
    </form>
</div>


{% endblock %}
